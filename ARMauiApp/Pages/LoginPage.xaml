<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="ARMauiApp.Pages.LoginPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:material="http://schemas.enisn-projects.io/dotnet/maui/uraniumui/material"
             xmlns:input="clr-namespace:InputKit.Shared.Controls;assembly=InputKit.Maui"
             xmlns:validation="clr-namespace:InputKit.Shared.Validations;assembly=InputKit.Maui"
             xmlns:m="clr-namespace:UraniumUI.Icons.MaterialSymbols;assembly=UraniumUI.Icons.MaterialSymbols"
             xmlns:viewmodels="clr-namespace:ARMauiApp.ViewModels"
             x:DataType="viewmodels:LoginViewModel"
             Title="Đăng nhập"
             Shell.NavBarIsVisible="False">

    <ScrollView>
        <Grid RowDefinitions="Auto,*,Auto" Padding="0" VerticalOptions="Center">
            <!-- Header -->
            <StackLayout Grid.Row="0" Margin="36,100,0,0" Spacing="0">
                <Label Text="Đăng nhập"
                       FontFamily="Raleway"
                       FontSize="52"
                       FontAttributes="Bold"
                       TextColor="#202020"
                       HorizontalOptions="Start" />
                <Label Text="Thật vui khi thấy bạn trở lại!"
                       FontFamily="Nunito Sans"
                       FontSize="19"
                       FontAttributes="None"
                       TextColor="#202020"
                       Margin="0,10,0,0"
                       HorizontalOptions="Start" />
            </StackLayout>

            <!-- Login Form -->
            <StackLayout Grid.Row="1" Margin="0,40,0,0" Spacing="24">
                <Frame BorderColor="White" BackgroundColor="Transparent" Padding="20,0" HasShadow="False" HeightRequest="57" HorizontalOptions="Center" WidthRequest="380">
                    <material:TextField Title="Email" 
                                       Text="{Binding Email}"
                                       Keyboard="Email"
                                       FontFamily="Poppins"
                                       FontSize="14"
                                       TextColor="#202020"
                                       CornerRadius="59"
                                       Icon="{FontImageSource FontFamily=MaterialSharp, Glyph={x:Static m:MaterialSharp.Mail}}">
                        <validation:RequiredValidation Message="Email là bắt buộc" />
                        <validation:RegexValidation Pattern="{x:Static input:AdvancedEntry.REGEX_EMAIL}" Message="Định dạng email không hợp lệ" />
                    </material:TextField>
                </Frame>
                <Frame BorderColor="White" BackgroundColor="Transparent" Padding="20,0" HasShadow="False" HeightRequest="57" HorizontalOptions="Center" WidthRequest="380">
                    <material:TextField Title="Password" 
                                       Text="{Binding Password}"
                                       IsPassword="True"
                                       FontFamily="Poppins"
                                       FontSize="14"
                                       TextColor="#202020"
                                       CornerRadius="59"
                                       Icon="{FontImageSource FontFamily=MaterialSharp, Glyph={x:Static m:MaterialSharp.Lock}}">
                        <validation:RequiredValidation Message="Mật khẩu là bắt buộc" />
                        <validation:MinLengthValidation MinLength="6" Message="Mật khẩu phải có ít nhất 6 ký tự" />
                    </material:TextField>
                </Frame>
                <!-- Next Button -->
                <Button Text="Đăng nhập"
                        Command="{Binding LoginCommand}"
                        IsEnabled="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}"
                        BackgroundColor="{StaticResource Primary}"
                        TextColor="#F3F3F3"
                        CornerRadius="16"
                        FontFamily="Nunito Sans"
                        FontSize="22"
                        HeightRequest="57"
                        FontAttributes="None"
                        Margin="0,20,0,0"
                        HorizontalOptions="Center"
                        WidthRequest="342">
                    <Button.Triggers>
                        <DataTrigger TargetType="Button" Binding="{Binding IsLoading}" Value="True">
                            <Setter Property="Text" Value="Đang đăng nhập..." />
                        </DataTrigger>
                    </Button.Triggers>
                </Button>

                <!-- Create Account -->
                <StackLayout Orientation="Horizontal" HorizontalOptions="Center" Margin="0,30,0,0" Spacing="5">
                    <Label Text="Chưa có tài khoản?"
                           FontFamily="Montserrat"
                           FontSize="14"
                           TextColor="#575757"
                           VerticalOptions="Center" />
                    
                    <Label Text="Đăng ký"
                           FontFamily="Montserrat"
                           FontSize="14"
                           FontAttributes="Bold"
                           TextColor="{StaticResource Primary}"
                           VerticalOptions="Center">
                        <Label.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding NavigateToRegisterCommand}" />
                        </Label.GestureRecognizers>
                    </Label>
                </StackLayout>
            </StackLayout>

            <!-- Loading Indicator -->
            <ActivityIndicator Grid.Row="1"
                              IsVisible="{Binding IsLoading}"
                              IsRunning="{Binding IsLoading}"
                              Color="{StaticResource Primary}"
                              VerticalOptions="Center"
                              HorizontalOptions="Center" />
        </Grid>
    </ScrollView>

</ContentPage>
